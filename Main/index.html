<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>restaurant mama üíï</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap');

        /* Responsive: ‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            .summary-grid {
                grid-template-columns: 1fr;
            }
            .add-menu-form {
                grid-template-columns: 1fr;
            }
            .control-buttons {
                grid-template-columns: 1fr;
            }
            /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏û‡∏î‡∏î‡∏¥‡πâ‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            * {
                font-size: 16px;
                padding: 0;
                margin: 0;
            }
            button, input, select, textarea {
                font-size: 14px;
                padding: 6px 10px;
            }
            .container {
                transform: scale(1); /* ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á container ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
                padding: 10px;
            }
            .header, .section {
                padding: 15px; /* ‡∏•‡∏î padding ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
                margin-bottom: 15px; /* ‡∏•‡∏î margin ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
                transform: scale(0.90); /* ‡∏¢‡πà‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡∏•‡∏á 10% (‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏° 5%) */
                transform-origin: top left; /* ‡πÉ‡∏´‡πâ‡∏¢‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏°‡∏∏‡∏°‡∏ã‡πâ‡∏≤‡∏¢‡∏ö‡∏ô */
                /* ******** ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ‡∏î‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ******** */
                border: 1px solid #333; /* ‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ‡∏î‡∏≥‡∏ö‡∏≤‡∏á‡πÜ */
                /* ********************************************** */
            }
            .form-group label {
                font-size: 1.2em;
            }
            select, input[type="number"], input[type="text"] {
                padding: 12px;
            }
            .btn-order, .btn-reset, .btn-export, .btn-add {
                padding: 12px 20px;
                font-size: 1.2em;
            }
        }

        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #A2D7DD 0%, #BEE6B4 100%); /* ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ */
            min-height: 100vh;
            color: #000;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            transform: scale(0.9); /* ‡∏¢‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á container ‡∏•‡∏á 90% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≠‡πÉ‡∏´‡∏ç‡πà */
            transform-origin: top left; /* ‡∏¢‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏°‡∏∏‡∏°‡∏ã‡πâ‡∏≤‡∏¢‡∏ö‡∏ô */
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            /* ******** ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ‡∏î‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥ ******** */
            border: 1px solid #333; /* ‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ‡∏î‡∏≥‡∏ö‡∏≤‡∏á‡πÜ */
            /* ************************************************* */
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .time-display {
            color: #7f8c8d;
            font-size: 1.3em;
            margin-bottom: 20px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 20px;
        }

        .summary-box {
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            font-size: 1.2em;
            font-weight: 600;
        }

        .total-sales {
            background: #27ae60;
            color: white;
        }

        .total-dishes {
            background: #3498db;
            color: white;
        }

        .avg-price {
            background: #f39c12;
            color: white;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            /* ******** ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ‡∏î‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥ ******** */
            border: 1px solid #333; /* ‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ‡∏î‡∏≥‡∏ö‡∏≤‡∏á‡πÜ */
            /* ************************************************* */
        }

        .section h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 1.8em;
            font-weight: 600;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 3px solid #e74c3c;
        }

        .order-form {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #2c3e50;
            font-weight: 600;
            font-size: 1.4em;
        }

        select, input[type="number"], input[type="text"] {
            width: 100%;
            padding: 20px;
            border: 3px solid #bdc3c7;
            border-radius: 10px;
            font-size: 1.4em;
            font-family: 'Kanit', sans-serif;
            background: white;
            color: #2c3e50;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.3);
        }

        .btn-order {
            background: #27ae60;
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 10px;
            font-size: 1.6em;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            font-family: 'Kanit', sans-serif;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .btn-order:hover {
            background: #219a52;
            transform: scale(1.02);
        }

        .btn-order:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }

        .add-menu-section {
            background: #ecf0f1;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .add-menu-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
            text-align: center;
        }

        .add-menu-form {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 15px;
            align-items: end;
        }

        .btn-add {
            background: #3498db;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            font-family: 'Kanit', sans-serif;
            font-weight: 600;
        }

        .btn-add:hover {
            background: #2980b9;
        }

        .menu-stats {
            margin-top: 20px;
        }

        .menu-item-stat {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid #3498db; /* Default border */
        }

        .menu-name {
            font-weight: 600;
            color: #2c3e50;
        }

        .menu-count {
            background: #27ae60;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
        }

        .sales-history {
            max-height: 400px;
            overflow-y: auto;
        }

        .sale-item {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid #27ae60;
        }

        .sale-info {
            flex: 1;
        }

        .sale-name {
            font-weight: 600;
            color: #2c3e50;
        }

        .sale-time {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .sale-price {
            color: #27ae60;
            font-weight: 700;
            font-size: 1.1em;
            margin-right: 10px;
        }

        .btn-delete {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Kanit', sans-serif;
        }

        .control-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .btn-reset, .btn-export {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            font-family: 'Kanit', sans-serif;
        }

        .btn-reset {
            background: #e74c3c;
            color: white;
        }

        .btn-export {
            background: #9b59b6;
            color: white;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 20px 30px;
            border-radius: 10px;
            display: none;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            font-size: 1.1em;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üçú ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏ô</h1>
            <div class="time-display" id="currentTime"></div>

            <div class="summary-grid">
                <div class="summary-box total-sales">
                    üí∞ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°<br>
                    <span id="totalSales">0</span> ‡∏ö‡∏≤‡∏ó
                </div>
                <div class="summary-box total-dishes">
                    üçΩÔ∏è ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏ô‡∏£‡∏ß‡∏°<br>
                    <span id="totalDishes">0</span> ‡∏à‡∏≤‡∏ô
                </div>
                <div class="summary-box avg-price">
                    üìä ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î<br>
                    <span id="avgPrice">0</span> ‡∏ö‡∏≤‡∏ó
                </div>
                <div class="summary-box" style="background: #e67e22; color: white;">
                    üóìÔ∏è ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢/‡∏ß‡∏±‡∏ô (7 ‡∏ß‡∏±‡∏ô)<br>
                    <span id="avgDailySales">0</span> ‡∏ö‡∏≤‡∏ó/‡∏ß‡∏±‡∏ô
                </div>
                </div>
        </div>

        <div class="main-content">
            <div class="section">
                <h2>üõí ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h2>

                <div class="order-form">
                    <div class="form-group">
                        <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π:</label>
                        <select id="menuSelect">
                        <option value="">   ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£   </option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏ô:</label>
                        <input type="number" id="quantity" value="1" min="1" onchange="updateOrderButtonState()">
                    </div>

                    <button class="btn-order" id="orderBtn" onclick="orderFood()" disabled>
                        üçΩÔ∏è ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£
                    </button>
                </div>

                <div class="menu-stats">
                    <h3 style="margin-bottom: 15px; color: #2c3e50;">üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏°‡∏ô‡∏π</h3>
                    <div id="menuStatsList">
                        <p style="text-align: center; color: #7f8c8d; padding: 20px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h2>

                <div class="sales-history" id="salesHistory">
                    <p style="text-align: center; color: #7f8c8d; padding: 30px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</p>
                </div>

                <div class="control-buttons">
                    <button class="btn-reset" onclick="resetAll()">üóëÔ∏è ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                    <button class="btn-export" onclick="exportData()">üìÑ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                </div>

                ---

                <div style="margin-top: 30px;">
                    <h2>üìä ‡∏Å‡∏£‡∏≤‡∏ü‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h2>
                    <div style="width: 90%; margin: auto; height: 400px;"> <canvas id="salesChart"></canvas>
                    </div>
                    <p style="text-align: center; color: #7f8c8d; font-size: 0.9em; margin-top: 15px;">
                        ‡πÅ‡∏™‡∏î‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á 30 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        const menuItems = [
            { id: 1, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏Å‡∏∏‡πâ‡∏á", price: 60, soldCount: 0 },
            { id: 2, name: "‡∏ú‡∏±‡∏î‡πÑ‡∏ó‡∏¢‡∏´‡∏°‡∏π", price: 50, soldCount: 0 },
            { id: 3, name: "‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á", price: 80, soldCount: 0 },
            { id: 4, name: "‡∏ú‡∏±‡∏î‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡πÑ‡∏Å‡πà", price: 45, soldCount: 0 },
            { id: 5, name: "‡∏™‡πâ‡∏°‡∏ï‡∏≥‡πÑ‡∏ó‡∏¢", price: 40, soldCount: 0 },
            { id: 6, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏°‡∏±‡∏ô‡πÑ‡∏Å‡πà", price: 50, soldCount: 0 },
            { id: 7, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏Ç‡∏≤‡∏´‡∏°‡∏π", price: 55, soldCount: 0 },
            { id: 8, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏°‡∏π‡πÅ‡∏î‡∏á", price: 50, soldCount: 0 },
            { id: 9, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏°‡∏π‡∏Å‡∏£‡∏≠‡∏ö", price: 55, soldCount: 0 },
            { id: 10, name: "‡∏£‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏°‡∏π", price: 50, soldCount: 0 },
            { id: 11, name: "‡∏ú‡∏±‡∏î‡∏ã‡∏µ‡∏≠‡∏¥‡πä‡∏ß‡πÑ‡∏Å‡πà", price: 45, soldCount: 0 },
            { id: 12, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏õ‡∏π", price: 70, soldCount: 0 },
            { id: 13, name: "‡∏ú‡∏±‡∏î‡πÄ‡∏ú‡πá‡∏î‡∏´‡∏°‡∏π‡∏õ‡πà‡∏≤", price: 60, soldCount: 0 },
            { id: 14, name: "‡πÅ‡∏Å‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏´‡∏ß‡∏≤‡∏ô‡πÑ‡∏Å‡πà", price: 55, soldCount: 0 },
            { id: 15, name: "‡∏ú‡∏±‡∏î‡∏û‡∏£‡∏¥‡∏Å‡πÅ‡∏Å‡∏á‡∏´‡∏°‡∏π", price: 50, soldCount: 0 },
            { id: 16, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏ï‡πâ‡∏°‡∏Å‡∏∏‡πâ‡∏á", price: 45, soldCount: 0 },
            { id: 17, name: "‡πÄ‡∏Å‡∏≤‡πÄ‡∏´‡∏•‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏´‡∏°‡∏π", price: 50, soldCount: 0 },
            { id: 18, name: "‡∏´‡∏°‡∏µ‡πà‡∏Å‡∏£‡∏∞‡πÄ‡∏â‡∏î‡∏´‡∏°‡∏π‡∏Å‡∏£‡∏≠‡∏ö", price: 60, soldCount: 0 },
            { id: 19, name: "‡∏Å‡πã‡∏ß‡∏¢‡∏à‡∏±‡πä‡∏ö‡∏ç‡∏ß‡∏ô", price: 55, soldCount: 0 },
            { id: 20, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡πÑ‡∏Ç‡πà‡πÄ‡∏à‡∏µ‡∏¢‡∏ß‡∏´‡∏°‡∏π‡∏™‡∏±‡∏ö", price: 35, soldCount: 0 }
        ];

        let salesHistory = [];
        let totalSales = 0;
        let totalDishes = 0;
        let dailySales = {}; // Format: { "YYYY-MM-DD": totalSalesForThatDay, ... }
        let salesChartInstance = null; // ‡πÄ‡∏Å‡πá‡∏ö instance ‡∏Ç‡∏≠‡∏á Chart.js
        let lastResetDate = ''; // ‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô

        window.onload = function() {
            updateTime();
            setInterval(updateTime, 1000);
            loadDataFromLocalStorage(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
            checkMidnight(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
            setInterval(checkMidnight, 60000); // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏∏‡∏Å‡∏ô‡∏≤‡∏ó‡∏µ
            updateMenuSelect();
            updateMenuStats();
            updateSalesHistory();
            updateSummary();
            renderSalesChart(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å

            document.getElementById('menuSelect').addEventListener('change', updateOrderButtonState);
            document.getElementById('quantity').addEventListener('input', updateOrderButtonState);
        };

        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('th-TH', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('currentTime').textContent = timeString;
        }

        function checkMidnight() {
            const now = new Date();
            const todayDateString = now.toISOString().slice(0, 10); // YYYY-MM-DD

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (lastResetDate !== todayDateString) {
                // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
                resetDailyStats();
                lastResetDate = todayDateString; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                saveDataToLocalStorage(); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÉ‡∏´‡∏°‡πà
                showNotification('üåô ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß! ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô
        function resetDailyStats() {
            menuItems.forEach(item => {
                item.soldCount = 0; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏°‡∏ô‡∏π
            });
            // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï dailySales ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≤‡∏ü 30 ‡∏ß‡∏±‡∏ô‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà
            // ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏° ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏ô‡∏£‡∏ß‡∏°‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            totalSales = 0;
            totalDishes = 0;
            salesHistory = []; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô

            updateMenuSelect();
            updateMenuStats();
            updateSalesHistory();
            updateSummary();
            document.getElementById('menuSelect').value = '';
            document.getElementById('quantity').value = '1';
            updateOrderButtonState();
            renderSalesChart(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
        }


        function updateMenuSelect() {
            const select = document.getElementById('menuSelect');
            const currentValue = select.value;

            select.innerHTML = '<option value=""> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£ </option>';

            menuItems.forEach(item => {
                const option = document.createElement('option');
                option.value = item.id;
                option.textContent = `${item.name} | ${item.price} ‡∏ö‡∏≤‡∏ó`;
                select.appendChild(option);
            });

            // Restore selection if possible
            if (currentValue) {
                select.value = currentValue;
            }
            updateOrderButtonState(); // Ensure button state is correct after updating select
        }

        function updateOrderButtonState() {
            const selectElement = document.getElementById('menuSelect');
            const quantityInput = document.getElementById('quantity');
            const orderBtn = document.getElementById('orderBtn');

            const selectedId = parseInt(selectElement.value);
            const quantity = parseInt(quantityInput.value);

            orderBtn.disabled = !selectedId || isNaN(quantity) || quantity <= 0;
        }

        function orderFood() {
            const selectElement = document.getElementById('menuSelect');
            const selectedId = parseInt(selectElement.value);
            const quantityInput = document.getElementById('quantity');
            const quantity = parseInt(quantityInput.value);

            if (!selectedId) {
                showNotification('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }

            if (isNaN(quantity) || quantity <= 0) {
                showNotification('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0)');
                return;
            }

            const menuItem = menuItems.find(item => item.id === selectedId);
            if (!menuItem) {
                showNotification('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å');
                return;
            }

            menuItem.soldCount += quantity;

            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô
            const today = new Date().toISOString().slice(0, 10); // Format YYYY-MM-DD
            if (!dailySales[today]) {
                dailySales[today] = 0;
            }
            dailySales[today] += menuItem.price * quantity;

            for (let i = 0; i < quantity; i++) {
                const sale = {
                    id: Date.now() + i,
                    menuId: selectedId,
                    name: menuItem.name,
                    price: menuItem.price,
                    time: new Date().toLocaleString('th-TH')
                };
                salesHistory.unshift(sale);
            }

            totalSales += menuItem.price * quantity;
            totalDishes += quantity;

            updateMenuSelect();
            updateMenuStats();
            updateSalesHistory();
            updateSummary();
            saveDataToLocalStorage(); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£
            renderSalesChart(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£

            showNotification(`‚úÖ ‡∏™‡∏±‡πà‡∏á "${menuItem.name}" ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${quantity} ‡∏à‡∏≤‡∏ô ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`);
        }

        // Function to add new menu (currently commented out in HTML)
        function addMenu() {
            const name = document.getElementById('newMenuName').value.trim();
            const price = parseFloat(document.getElementById('newMenuPrice').value);

            if (!name || !price || price <= 0) {
                showNotification('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                return;
            }

            const newMenu = {
                id: Date.now(),
                name: name,
                price: price,
                soldCount: 0
            };

            menuItems.push(newMenu);

            updateMenuSelect();
            updateMenuStats();

            document.getElementById('newMenuName').value = '';
            document.getElementById('newMenuPrice').value = '';

            saveDataToLocalStorage(); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            showNotification(`‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π "${name}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢`);
        }

        function updateMenuStats() {
            const statsDiv = document.getElementById('menuStatsList');

            if (menuItems.length === 0) {
                statsDiv.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 20px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π</p>';
                return;
            }

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏≠‡∏≤‡∏£‡πå‡πÄ‡∏£‡∏¢‡πå‡πÄ‡∏î‡∏¥‡∏°
            const sortedMenuItems = [...menuItems].sort((a, b) => b.soldCount - a.soldCount);

            let html = '';
            html += '<h4 style="margin-bottom: 10px; color: #2c3e50;">ü•á ‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î:</h4>';
            // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ 3 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å
            const topSelling = sortedMenuItems.filter(item => item.soldCount > 0).slice(0, 3);
            if (topSelling.length > 0) {
                topSelling.forEach(item => {
                    html += `
                        <div class="menu-item-stat" style="border-left: 4px solid #27ae60;">
                            <div>
                                <div class="menu-name">${item.name}</div>
                                <div style="color: #7f8c8d; font-size: 0.9em;">‡∏£‡∏≤‡∏Ñ‡∏≤: ${item.price} ‡∏ö‡∏≤‡∏ó</div>
                            </div>
                            <div class="menu-count">${item.soldCount} ‡∏à‡∏≤‡∏ô</div>
                        </div>
                    `;
                });
            } else {
                html += '<p style="text-align: center; color: #7f8c8d; padding: 10px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ</p>';
            }

            html += '<h4 style="margin-top: 20px; margin-bottom: 10px; color: #2c3e50;">üìâ ‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏Ç‡∏≤‡∏¢ / ‡∏Ç‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î:</h4>';
            // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏Ç‡∏≤‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° `cost` ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏≥‡πÑ‡∏£)
            const worstSelling = [...menuItems].filter(item => item.soldCount === 0);
            if (worstSelling.length > 0) {
                // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏Ç‡∏≤‡∏¢
                worstSelling.sort((a, b) => a.price - b.price).slice(0, 3).forEach(item => {
                    html += `
                        <div class="menu-item-stat" style="border-left: 4px solid #e74c3c;">
                            <div>
                                <div class="menu-name">${item.name}</div>
                                <div style="color: #7f8c8d; font-size: 0.9em;">‡∏£‡∏≤‡∏Ñ‡∏≤: ${item.price} ‡∏ö‡∏≤‡∏ó</div>
                            </div>
                            <div class="menu-count">0 ‡∏à‡∏≤‡∏ô</div>
                        </div>
                    `;
                });
            } else if (sortedMenuItems.length > 0) { // ‡∏ñ‡πâ‡∏≤‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß
                 // ‡πÅ‡∏™‡∏î‡∏á 3 ‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡πÅ‡∏ï‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0 ‡∏à‡∏≤‡∏ô)
                const lowestSold = sortedMenuItems.filter(item => item.soldCount > 0).slice(-3);
                if (lowestSold.length > 0) {
                     lowestSold.forEach(item => {
                        html += `
                            <div class="menu-item-stat" style="border-left: 4px solid #e74c3c;">
                                <div>
                                    <div class="menu-name">${item.name}</div>
                                    <div style="color: #7f8c8d; font-size: 0.9em;">‡∏£‡∏≤‡∏Ñ‡∏≤: ${item.price} ‡∏ö‡∏≤‡∏ó</div>
                                </div>
                                <div class="menu-count">${item.soldCount} ‡∏à‡∏≤‡∏ô</div>
                            </div>
                        `;
                    });
                } else {
                    html += '<p style="text-align: center; color: #7f8c8d; padding: 10px;">‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß!</p>';
                }

            } else {
                 html += '<p style="text-align: center; color: #7f8c8d; padding: 10px;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>';
            }

            statsDiv.innerHTML = html;
        }

        function updateSalesHistory() {
            const historyDiv = document.getElementById('salesHistory');

            if (salesHistory.length === 0) {
                historyDiv.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 30px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</p>';
                return;
            }

            let html = '';
            salesHistory.slice(0, 15).forEach(sale => {
                html += `
                    <div class="sale-item">
                        <div class="sale-info">
                            <div class="sale-name">${sale.name}</div>
                            <div class="sale-time">${sale.time}</div>
                        </div>
                        <div class="sale-price">${sale.price} ‡∏ö‡∏≤‡∏ó</div>
                        <button class="btn-delete" onclick="deleteSale(${sale.id})" title="‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£">üóëÔ∏è</button>
                    </div>
                `;
            });

            historyDiv.innerHTML = html;
        }

        function deleteSale(saleId) {
            const saleIndex = salesHistory.findIndex(s => s.id === saleId);
            if (saleIndex === -1) return;

            const sale = salesHistory[saleIndex];

            if (confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ "${sale.name}" (‡πÄ‡∏ß‡∏•‡∏≤ ${sale.time}) ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                salesHistory.splice(saleIndex, 1);

                const menuItem = menuItems.find(item => item.id === sale.menuId);
                if (menuItem && menuItem.soldCount > 0) {
                    menuItem.soldCount--;
                }

                // ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô
                const saleDate = new Date(sale.time).toISOString().slice(0, 10); // Extract date from sale time
                if (dailySales[saleDate]) {
                    dailySales[saleDate] -= sale.price;
                    if (dailySales[saleDate] < 0) dailySales[saleDate] = 0; // Prevent negative sales
                }

                totalSales -= sale.price;
                totalDishes--;

                updateMenuSelect();
                updateMenuStats();
                updateSalesHistory();
                updateSummary();
                saveDataToLocalStorage(); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                renderSalesChart(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£

                showNotification(`üóëÔ∏è ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß`);
            }
        }

        function updateSummary() {
            document.getElementById('totalSales').textContent = totalSales.toLocaleString();
            document.getElementById('totalDishes').textContent = totalDishes.toLocaleString();

            const avgPrice = totalDishes > 0 ? Math.round(totalSales / totalDishes) : 0;
            document.getElementById('avgPrice').textContent = avgPrice;

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô
            const avgDailySalesLast7Days = calculateAverageDailySales(7);
            const avgDailySalesElement = document.getElementById('avgDailySales');
            if (avgDailySalesElement) {
                avgDailySalesElement.textContent = avgDailySalesLast7Days.toLocaleString();
            }
        }

        function resetAll() { // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï *‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î* ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
            if (salesHistory.length > 0 || totalDishes > 0) {
                if (!confirm('‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ')) {
                    return;
                }
            }

            salesHistory = [];
            totalSales = 0;
            totalDishes = 0;
            dailySales = {}; // Reset daily sales data
            lastResetDate = ''; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏î‡πâ‡∏ß‡∏¢

            menuItems.forEach(item => {
                item.soldCount = 0;
            });

            updateMenuSelect();
            updateMenuStats();
            updateSalesHistory();
            updateSummary();
            document.getElementById('menuSelect').value = '';
            document.getElementById('quantity').value = '1';
            updateOrderButtonState();
            saveDataToLocalStorage(); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
            renderSalesChart(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï

            showNotification('üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß');
        }

        function exportData() {
            if (salesHistory.length === 0) {
                showNotification('‚ÑπÔ∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å');
                return;
            }

            let data = `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£\n`;
            data += `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${new Date().toLocaleDateString('th-TH')}\n\n`;
            data += `‡∏™‡∏£‡∏∏‡∏õ:\n`;
            data += `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°: ${totalSales.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`;
            data += `‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏ô: ${totalDishes} ‡∏à‡∏≤‡∏ô\n`;
            data += `‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ${totalDishes > 0 ? Math.round(totalSales / totalDishes) : 0} ‡∏ö‡∏≤‡∏ó/‡∏à‡∏≤‡∏ô\n`;
            data += `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${calculateAverageDailySales(7).toLocaleString()} ‡∏ö‡∏≤‡∏ó/‡∏ß‡∏±‡∏ô\n\n`; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ

            data += `‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏°‡∏ô‡∏π (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢):\n`;
            menuItems.sort((a, b) => b.soldCount - a.soldCount).forEach(item => {
                if (item.soldCount > 0) {
                    data += `${item.name}: ${item.soldCount} ‡∏à‡∏≤‡∏ô (${item.soldCount * item.price} ‡∏ö‡∏≤‡∏ó)\n`;
                }
            });

            data += `\n‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (30 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î):\n`;
            const sortedDates = Object.keys(dailySales).sort(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
            sortedDates.forEach(date => {
                data += `${new Date(date).toLocaleDateString('th-TH')}: ${dailySales[date].toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`;
            });


            data += `\n‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ (‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î 15 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£):\n`;
            salesHistory.slice(0, 15).forEach((sale, index) => {
                data += `${index + 1}. ${sale.name} - ${sale.price} ‡∏ö‡∏≤‡∏ó (${sale.time})\n`;
            });

            const blob = new Blob([data], { type: 'text/plain;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            window.URL.revokeObjectURL(url);

            showNotification('üìÑ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß');
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢ Local Storage
        function saveDataToLocalStorage() {
            localStorage.setItem('menuItems', JSON.stringify(menuItems));
            localStorage.setItem('salesHistory', JSON.stringify(salesHistory));
            localStorage.setItem('totalSales', totalSales);
            localStorage.setItem('totalDishes', totalDishes);
            localStorage.setItem('dailySales', JSON.stringify(dailySales)); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å dailySales
            localStorage.setItem('lastResetDate', lastResetDate); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
        }

        function loadDataFromLocalStorage() {
            const storedMenuItems = localStorage.getItem('menuItems');
            if (storedMenuItems) {
                const parsedMenuItems = JSON.parse(storedMenuItems);
                menuItems.forEach(item => {
                    const storedItem = parsedMenuItems.find(sItem => sItem.id === item.id);
                    if (storedItem) {
                        item.soldCount = storedItem.soldCount;
                    }
                });
                parsedMenuItems.forEach(storedItem => {
                    if (!menuItems.some(item => item.id === storedItem.id)) {
                        menuItems.push(storedItem);
                    }
                });
            }

            const storedSalesHistory = localStorage.getItem('salesHistory');
            if (storedSalesHistory) {
                salesHistory = JSON.parse(storedSalesHistory);
            }

            const storedTotalSales = localStorage.getItem('totalSales');
            if (storedTotalSales !== null) {
                totalSales = parseInt(storedTotalSales);
            }

            const storedTotalDishes = localStorage.getItem('totalDishes');
            if (storedTotalDishes !== null) {
                totalDishes = parseInt(storedTotalDishes);
            }

            const storedDailySales = localStorage.getItem('dailySales');
            if (storedDailySales) {
                dailySales = JSON.parse(storedDailySales);
            }

            const storedLastResetDate = localStorage.getItem('lastResetDate');
            if (storedLastResetDate) {
                lastResetDate = storedLastResetDate;
            }
        }


        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô
        function calculateAverageDailySales(days = 7) {
            let totalSalesInPeriod = 0;
            let numDaysWithSales = 0;

            const today = new Date();

            for (let i = 0; i < days; i++) {
                const d = new Date(today);
                d.setDate(today.getDate() - i);
                const dateString = d.toISOString().slice(0, 10);

                if (dailySales[dateString] !== undefined && dailySales[dateString] > 0) {
                    totalSalesInPeriod += dailySales[dateString];
                    numDaysWithSales++;
                }
            }
            return numDaysWithSales > 0 ? (totalSalesInPeriod / numDaysWithSales).toFixed(2) : 0;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢
        function renderSalesChart() {
            const ctx = document.getElementById('salesChart').getContext('2d');

            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü (30 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)
            const labels = [];
            const data = [];
            const today = new Date();

            for (let i = 29; i >= 0; i--) { // ‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏õ 30 ‡∏ß‡∏±‡∏ô (‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ)
                const d = new Date(today);
                d.setDate(today.getDate() - i);
                const dateString = d.toISOString().slice(0, 10); // YYYY-MM-DD
                const formattedDate = d.toLocaleDateString('th-TH', { month: 'short', day: 'numeric' }); // ‡πÄ‡∏ä‡πà‡∏ô "‡∏Å.‡∏Ñ. 20"

                labels.push(formattedDate);
                data.push(dailySales[dateString] || 0); // ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô 0
            }

            // ‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏Å‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏î‡πÉ‡∏´‡∏°‡πà
            if (salesChartInstance) {
                salesChartInstance.destroy();
            }

            salesChartInstance = new Chart(ctx, {
                type: 'line', // ‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏™‡πâ‡∏ô
                data: {
                    labels: labels,
                    datasets: [{
                        label: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)',
                        data: data,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderWidth: 2,
                        tension: 0.4, // ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡πÇ‡∏Ñ‡πâ‡∏á‡∏°‡∏ô
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false, // ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≤‡∏ü‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏≤‡∏° div
                    plugins: {
                        title: {
                            display: true,
                            text: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (30 ‡∏ß‡∏±‡∏ô)', // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏≤‡∏ü
                            font: {
                                size: 18,
                                family: 'Kanit'
                            },
                            color: '#2c3e50'
                        },
                        legend: {
                            display: false // ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á legend
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)',
                                font: {
                                    family: 'Kanit'
                                }
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString(); // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏Ñ‡∏≠‡∏°‡∏°‡πà‡∏≤
                                },
                                font: {
                                    family: 'Kanit'
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà',
                                font: {
                                    family: 'Kanit'
                                }
                            },
                            ticks: {
                                font: {
                                    family: 'Kanit'
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>